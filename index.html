<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Project 4: Auto-stitching Photo Mosaics</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-default_background {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-transparentGray { background-color: rgba(227, 226, 224, 0); }
.select-value-color-translucentGray { background-color: rgba(0, 0, 0, 0.06); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="1250aaf5-eccb-8088-bf0c-f0ab6c966123" class="page sans"><header><h1 class="page-title">Project 4: <strong>Auto-stitching Photo Mosaics</strong></h1><p class="page-description"></p></header><div class="page-body"><h2 id="1250aaf5-eccb-8034-b44f-c67056bbb247" class=""><strong><span style="border-bottom:0.05em solid">Part A</span></strong></h2><p id="1250aaf5-eccb-80d0-be0b-c3257fddc780" class="">In the first part of this project, we will be focusing on creating some preliminary photo mosaics by stitching together our own original photos! The steps for creating a mosaic is first recovering a homography matrix from correspondence points between images, warping the source image to reference image, and then finally blending the images together to make the mosaic. But before we can try creating mosaics, we need to capture some images and perform warps!</p><h3 id="1250aaf5-eccb-80ff-b00c-d9a3ca27a8fc" class="">Capturing Images</h3><p id="1250aaf5-eccb-807d-9f79-c05f5fae1365" class="">Here are some of the pictures that will be used throughout this project for the various subtasks.</p><div id="1250aaf5-eccb-807c-8bce-f5829a3f40c3" class="column-list"><div id="08f927ce-a2d8-4b6b-87ac-f4f7f77d1e49" style="width:50%" class="column"><figure id="1250aaf5-eccb-8073-abad-e87f7f9e3902" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/fsign.jpg"><img style="width:331px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/fsign.jpg"/></a></figure></div><div id="44d2bd6c-d983-46a6-805c-138fae2d0b3b" style="width:50%" class="column"><figure id="1250aaf5-eccb-8075-86c1-fec3c1dff33b" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/fpoker.jpg"><img style="width:331px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/fpoker.jpg"/></a></figure></div></div><p id="1250aaf5-eccb-801a-8520-e2b20966258f" class="">
</p><figure id="1250aaf5-eccb-8026-a3fc-c18c57c42f05" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/whiteboard.jpg"><img style="width:336px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/whiteboard.jpg"/></a></figure><p id="1250aaf5-eccb-804b-956f-cd025a6e0ec8" class="">Above, we have a few images of objects that we want to rectify. From left to right, we have a Cal Gameday sign, a poker set, and a small whiteboard. The goal with these images is to change the perspective of the photo to capture the face of the objects head on.</p><div id="1250aaf5-eccb-80d9-ace0-e6030c7d7048" class="column-list"><div id="6583003f-32b6-438c-845a-89727c97398d" style="width:50%" class="column"><figure id="1250aaf5-eccb-8080-b2b1-cf6ddc76daad" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/fforest0.jpg"><img style="width:331px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/fforest0.jpg"/></a></figure></div><div id="6109bf1d-e39e-4998-ac22-f3a30642afbe" style="width:50%" class="column"><figure id="1250aaf5-eccb-804e-bb08-c0bea0677ebd" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/fforest1.jpg"><img style="width:331px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/fforest1.jpg"/></a></figure></div></div><div id="1250aaf5-eccb-8053-9599-f01eac7a67f3" class="column-list"><div id="e76d2394-4bd5-48cf-9ec4-cd1d6f0b8786" style="width:50%" class="column"><figure id="1250aaf5-eccb-80c1-a9da-e971ca188c81" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/frm1.jpg"><img style="width:331px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/frm1.jpg"/></a></figure></div><div id="328b544f-f5da-4909-93b8-639264160e58" style="width:50%" class="column"><figure id="1250aaf5-eccb-806b-bde0-f9d85f82a544" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/frm0.jpg"><img style="width:331px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/frm0.jpg"/></a></figure></div></div><div id="1250aaf5-eccb-808f-b420-f677e4ab1493" class="column-list"><div id="ad48d35a-7eba-4fc5-9eb9-7b21b386dd04" style="width:50%" class="column"><figure id="1250aaf5-eccb-8073-9f36-d505fb48d4c2" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/room_1.jpg"><img style="width:330.9921875px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/room_1.jpg"/></a></figure></div><div id="5485e965-5b1c-43f4-b002-e27fc946b956" style="width:50%" class="column"><figure id="1250aaf5-eccb-8040-a19b-f63d1a93577d" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/room_2.jpg"><img style="width:330.9921875px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/room_2.jpg"/></a></figure></div></div><p id="1250aaf5-eccb-8023-a5a3-d850d3ed57b9" class="">The remainder of the images will be used to construct mosaics, stitching the two views together into one image. Now that we have all of our images, let’s jump into the subtasks, starting with the warping step.</p><h3 id="1250aaf5-eccb-8032-b08e-f9aacb9436d3" class="">Recovering Homographies</h3><p id="1250aaf5-eccb-8047-bf40-dda6cc667b15" class="">Unlike the previous project where we focused on performing an affine transform, we will be performing a homography in this case. The higher level process we are performing is going to be the same, but we will treat our homography matrix as our transform instead. Numerically in homography, we have 8 unknowns, which can be written out as the following</p><figure id="1250aaf5-eccb-8021-80be-db7ad76edc6f" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>H</mi><mi>p</mi><mo>=</mo><msup><mi>p</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mspace linebreak="newline"></mspace><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>a</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>b</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>c</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>d</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>e</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>f</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>g</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>h</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>x</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>y</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>w</mi><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>w</mi><msup><mi>y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>w</mi></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">Hp = p&#x27; \\
\begin{bmatrix}
    a &amp; b &amp; c \\
    d &amp; e &amp; f \\
    g &amp; h &amp; 1
    \end{bmatrix}
    \begin{bmatrix} x \\ y \\ 1 \end{bmatrix}
    =
    \begin{bmatrix} wx&#x27; \\ wy&#x27; \\ w \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9963em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='3.600em' viewBox='0 0 667 3600'><path d='M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">a</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">b</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">e</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">c</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='3.600em' viewBox='0 0 667 3600'><path d='M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='3.600em' viewBox='0 0 667 3600'><path d='M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='3.600em' viewBox='0 0 667 3600'><path d='M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='3.600em' viewBox='0 0 667 3600'><path d='M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='3.600em' viewBox='0 0 667 3600'><path d='M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span></span></span></span></span></div></figure><p id="1250aaf5-eccb-8002-a34c-e6aff9aa2ce6" class="">Here, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span></span><span>﻿</span></span> is our points in the source image which we want to transform to <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>p</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">p&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9463em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span>﻿</span></span> using <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span></span><span>﻿</span></span>. To fill out these variables, we will be defining correspondence points between our two images. As a result, we have the coordinates of each pixel in the source image and the corresponding points that match in the destination/reference image. Some examples are shown below.</p><figure id="1250aaf5-eccb-80cd-ae2c-e3dfdc0279d4" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image.png"><img style="width:707.984375px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image.png"/></a></figure><figure id="1250aaf5-eccb-807a-9f3e-f56eb12c4ccb" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%201.png"><img style="width:2390px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%201.png"/></a></figure><p id="1250aaf5-eccb-80c7-b6db-ff21c591e946" class="">With this information, we can solve for our 8 unknowns in the homography matrix. To help with solving the system, we can move around terms to get a new form that will help solve specifically for those unknowns. With some manipulation, we can rewrite the system of equations as the following.</p><figure id="1250aaf5-eccb-80ed-942e-dab3eb68a451" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center center center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>x</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>y</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mi>x</mi><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mi>y</mi><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>x</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>y</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mi>x</mi><msup><mi>y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mi>y</mi><msup><mi>y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>a</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>b</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>c</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>d</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>e</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>f</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>g</mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>h</mi></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mi>y</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix}
    x &amp; y &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; -xx&#x27; &amp; -yx&#x27; \\
    0 &amp; 0 &amp; 0 &amp; x &amp; y &amp; 1 &amp; -xy&#x27; &amp; -yy&#x27; \\
    \end{bmatrix}
    \begin{bmatrix} a \\ b \\ c \\ d \\ e \\ f \\ g \\ h \end{bmatrix}
    =
    \begin{bmatrix} x&#x27; \\ y&#x27; \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:9.6001em;vertical-align:-4.5501em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord mathnormal">x</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord mathnormal">x</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.0499em;"><span style="top:-7.0499em;"><span class="pstrut" style="height:11.6em;"></span><span style="width:0.667em;height:9.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='9.600em' viewBox='0 0 667 9600'><path d='M403 1759 V84 H666 V0 H319 V1759 v6000 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v6000 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.5501em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.05em;"><span style="top:-7.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">a</span></span></span><span style="top:-6.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">b</span></span></span><span style="top:-4.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">c</span></span></span><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">e</span></span></span><span style="top:-1.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span><span style="top:-0.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span><span style="top:1.19em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.55em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.0499em;"><span style="top:-7.0499em;"><span class="pstrut" style="height:11.6em;"></span><span style="width:0.667em;height:9.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='9.600em' viewBox='0 0 667 9600'><path d='M347 1759 V0 H0 V84 H263 V1759 v6000 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v6000 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.5501em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span><span style="top:-2.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.95em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></div></figure><p id="1250aaf5-eccb-80e2-b9b1-d0a5d33e0e39" class="">Repeating this formulation for each correspondence point stacked in a large matrix will give us our final system of equations we need to solve. However, we can notice that the system is overdetermined in this scenario, so we will need to perform find the least squares solution to determine our homography matrix. This is another reason why we put the equation in the format shown above since this is standard for least squares optimization problems. We can verify the homography calculations by performing the forward and inverse warp on the correspondence points to see if we have a 1-to-1 bijection between the two sets of correspondence points.</p><h3 id="1250aaf5-eccb-8013-84cc-fa35f113a798" class="">Image Rectification</h3><p id="1250aaf5-eccb-802b-ae01-f5643c152508" class="">With the newly acquired homography matrix, we can now define a function to warp and rectify images. Let’s consider the case of rectification to start off. Rectification is slightly different from the example of two images we have been using so far. We only have one image which contains an object that we want to rectify. The way we define our correspondences in this case is 1) create a bounding box for our object and then 2) define an arbitrary bounding box for the resulting rectification. The following images show both sets of points on the same canvas.</p><div id="1250aaf5-eccb-80f7-a8ea-f1fb8a0df636" class="column-list"><div id="42b6f4ef-db6d-48d2-9cd5-d789a297a193" style="width:50.000000000000014%" class="column"><figure id="1250aaf5-eccb-80f9-b784-ce14e2da268e" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%202.png"><img style="width:330.9921875px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%202.png"/></a></figure></div><div id="1250aaf5-eccb-809e-959c-f5cefe556b0a" style="width:50%" class="column"><figure id="1250aaf5-eccb-8071-afc2-f7001ba286cc" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%203.png"><img style="width:330.9921875px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%203.png"/></a></figure></div></div><p id="1250aaf5-eccb-80bd-824a-eac90f1e7ad0" class="">In both cases, the blue points define the surface that we want to rectify and the yellow points show the target bounding box. The sizes of the arbitrary targets were calculated using the approximate sizes of the actual surfaces, so the rectification performs a reasonable transform. In the poker example, I chose to put the poker box at an angle to see how the rectification would perform differently from the simpler case in the sign. Once we have the correspondences defined, we can extract a homography matrix from the transform between the point sets. Now, let’s define our warp function.</p><p id="1250aaf5-eccb-8076-ac1a-fdc5a248ec71" class="">For the warp, we start by creating our new canvas for the image post warp. To do this, we take the original corners of our image and apply our calculated homography matrix, giving us a set of four transformed corners for our final images. Sometimes our transformed points are negative, so we need to define a translation operation that we need to perform after our homography. We can look at the minimum x and y values for the transformed corners and shift them to be 0 in the new coordinate frame. This way we will always have our image “at the origin” on our new canvas instead of having really large values or having negative values. We can define our translation operation also as a matrix of the form:</p><figure id="1250aaf5-eccb-80c9-8a9d-e343af79aecb" class="equation"><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><div class="equation-container"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>T</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.16em" columnalign="center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><msub><mi>x</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><msub><mi>y</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">T = \begin{bmatrix}
    1 &amp; 0 &amp; -x_{min} \\
    0 &amp; 1 &amp; -y_{min} \\
    0 &amp; 0 &amp; 1
    \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='3.600em' viewBox='0 0 667 3600'><path d='M403 1759 V84 H666 V0 H319 V1759 v0 v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v0 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.81em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.667em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.667em' height='3.600em' viewBox='0 0 667 3600'><path d='M347 1759 V0 H0 V84 H263 V1759 v0 v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v0 v1759 h84z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span></span></span></span></span></div></figure><p id="1250aaf5-eccb-80eb-9605-f17fa76187f2" class="">In essence, we are applying a homography matrix <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span></span></span></span></span><span>﻿</span></span> followed by a translation matrix <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span></span><span>﻿</span></span>, which will be an important fact for later on in the warping process. For the examples above, these are the final transformed corners for the new images.</p><div id="1250aaf5-eccb-8052-b414-d675e2c6a57a" class="column-list"><div id="8fb0934a-1aed-44d0-adc5-47366517d952" style="width:50%" class="column"><figure id="1250aaf5-eccb-80c6-a173-c7ece69fca2b" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%204.png"><img style="width:330.9921875px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%204.png"/></a></figure></div><div id="f1b5d5dd-67ec-45f5-9845-533d06dbc403" style="width:50%" class="column"><figure id="1250aaf5-eccb-8057-a97c-c1eb80b7a233" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%205.png"><img style="width:330.9921875px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%205.png"/></a></figure></div></div><p id="1250aaf5-eccb-8093-8690-f4651e568d42" class="">Once we have our transformed corners, we can interpolate the values of the original image in the new rectified image. We start by collecting all of the points contained in both the original image (which is just every pixel) and the polygon enclosed in the 4 transformed corners. Each transformed point will have the inverse of the homography matrix and translation matrix we defined before applied to it to recover the corresponding pixel in the original image. Applying this for every transformed point, we can then perform interpolation using <code>scipy.interpolate.griddata</code> with the transformed points, corresponding recovered points, and the RGB values from the original image. After interpolating, we get the results below.</p><div id="1250aaf5-eccb-809d-bfab-dc7c9ce878dd" class="column-list"><div id="2acbbc0f-8daa-4041-8cb3-431fb518e6d3" style="width:50%" class="column"><figure id="1250aaf5-eccb-8076-bd0a-f3d7881906a0" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%206.png"><img style="width:330.9921875px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%206.png"/></a></figure></div><div id="5c6eb9d3-454b-45a2-9442-406a4655be1b" style="width:50%" class="column"><figure id="1250aaf5-eccb-80aa-a648-f72bceee8aa6" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%207.png"><img style="width:330.9921875px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%207.png"/></a></figure></div></div><p id="1250aaf5-eccb-80d5-8291-fcb1e26a5428" class="">First point to notice in both is that the perspective of the image now shows our desired targets rectified or facing the camera view head on. In the photo with the Cal sign, the result turned out really good with very clear definitions on the shape of orientation of the sign. For the poker example, the result is much smaller (the shown image is a smaller crop of the whole transformed image) and much harder to tell whether it was rectified. The results of the rectification are very sensitive to smaller changes in the correspondence points as well as the orientation of the objects in the image, which is why the poker example turned out the way it did. Here is another example of rectification, this time performed on a whiteboard. One cool aspect of this is that the same sign we saw before is also rectified in the process since it is on the same plane as the whiteboard!</p><div id="1250aaf5-eccb-80a1-befc-c68c62269c76" class="column-list"><div id="c1706211-600e-41c7-a5d9-c6cea8517e93" style="width:50%" class="column"><figure id="1250aaf5-eccb-809e-b825-e98dcc326ee9" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%208.png"><img style="width:330.9921875px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%208.png"/></a></figure></div><div id="cde90663-f617-42aa-a0a5-46cbbaa507a5" style="width:50%" class="column"><figure id="1250aaf5-eccb-80d9-b889-ff072f1b74d8" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%209.png"><img style="width:258px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%209.png"/></a></figure></div></div><h3 id="1250aaf5-eccb-8022-ae19-df46078b9a92" class="">Warp Images</h3><p id="1250aaf5-eccb-800d-b040-d2a6c2c7ed17" class="">Now that we have rectified images, we can perform the same operations on a set of two images to warp then to each other. This will aid us in creating our photo mosaics next. As with before, we need to define our correspondences, but instead of doing it on the same image, we do it across different images.</p><figure id="1250aaf5-eccb-80ed-b88d-e1d1b7008f58" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%2010.png"><img style="width:707.9921875px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%2010.png"/></a></figure><p id="1250aaf5-eccb-801b-9351-ec2edb6e6795" class="">Here, we have 16 correspondence points between the two images. Using these points, we can calculate our homography matrix like before, and then transform one of the images into the perspective of the other image. In this example, I will be warping the left image to the right one. The resulting transformed corners and final warped image are shown below.</p><div id="1250aaf5-eccb-8017-a38e-d74e619ccd68" class="column-list"><div id="55e1eb19-5ab8-4ecb-87f9-d7bcbb30ae7a" style="width:56.25%" class="column"><figure id="1250aaf5-eccb-80dd-8e99-db9376a893ee" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%2011.png"><img style="width:432px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%2011.png"/></a></figure></div><div id="1250aaf5-eccb-8073-ad2a-ccc9a3073f95" style="width:43.75%" class="column"><figure id="1250aaf5-eccb-80f5-aa68-e9b966e1742f" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%2012.png"><img style="width:288px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%2012.png"/></a></figure></div></div><p id="1250aaf5-eccb-800c-8bc1-fceaae5d344b" class="">During the warping, I saw some extra artifacts that were a byproduct of the operation, so they were removed from the result shown above. That is why the resulting transformation differs in dimensions from the projected warped corners. Let’s look at a few more examples of this warping operation!</p><figure id="1250aaf5-eccb-8099-a983-d1898cca9d09" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%2013.png"><img style="width:707.984375px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%2013.png"/></a></figure><p id="1250aaf5-eccb-807a-81c6-df8c9a7717f1" class="">Here are the correspondence points between two images of my living room. Applying the same steps to these images, we get the following warped image.</p><div id="1250aaf5-eccb-80b3-a1f6-cbc6adec768e" class="column-list"><div id="1250aaf5-eccb-802a-ab7e-f6580a7d3533" style="width:56.25%" class="column"><figure id="1250aaf5-eccb-80e0-b486-ffba7f169cf0" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%2014.png"><img style="width:384px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%2014.png"/></a></figure></div><div id="1250aaf5-eccb-800c-84f5-fdaef08bc816" style="width:43.74999999999999%" class="column"><figure id="1250aaf5-eccb-8086-a38c-e25a9265cd9a" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%2015.png"><img style="width:331px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%2015.png"/></a></figure></div></div><p id="1250aaf5-eccb-804e-b6b6-e7f91cbe124f" class="">One point to notice here is that we see more pixelation in this scenario compared to the previous case, likely due to the scale of the warping that occurred with this image compared to the previous one. In particular, the windows seem to lose information possibly due to the reflections along with the downsizing of the image during these operations. Let’s build some mosaics out of these images a few others!</p><h3 id="1250aaf5-eccb-8052-aee8-f0c61f59fda5" class="">Photo Mosaics</h3><p id="1250aaf5-eccb-80b0-a82c-d96ae92a7b45" class="">To actually create a mosaic out of our images, we need to first align our images on the same canvas and then blend them together. Looking back at the forest example, we can start by transforming our correspondence points from before to new the canvas of our warped image, giving us the result below. We perform this operation using the homography and translation matrices for this warp.</p><figure id="1250aaf5-eccb-807b-b771-e4d9f5f43a51" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%2016.png"><img style="width:2390px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%2016.png"/></a></figure><p id="1250aaf5-eccb-80c4-8285-dee5b9c83799" class="">We can use our correspondence points to actually align our images since they are points in the resulting image that should be overlapping. However, since homography is an approximate transformation using least squares, we can’t guarantee that all of the correspondence points will be exactly mapped to the target, but instead very close to it. With this in mind, I defined a function to find the best alignment of the two images within a range of values. This function is very similar to the naive alignment algorithm we used in project 1, but uses the correspondence points as a reference starting point to avoid the need of down- and up-sizing our images. With our optimal alignment, we can define a new translation matrix like before to transform our second image to our first, making our first image the base for our canvas.</p><p id="1250aaf5-eccb-80f0-a301-e0749c034b6f" class="">To define the bounds of this new canvas, we can use a similar method as what we used for defining our warped canvas, but this time we have two sets of corners. We can find the minimum and maximum x’s and y’s across all of the corners for both images, which will then set our size for the output mosaic size. We can then just add both of images to the new canvas, where the warped image can be added directly and the second image will be translated into the canvas based on our calculated optimal alignment. To blend the images, we apply alpha blending at the pixels where the two images are overlapping to make sure we get a smooth stitching. The result of the alignment and stitching is as follows.</p><figure id="1250aaf5-eccb-80d2-ba14-e838907d10a5" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%2017.png"><img style="width:630px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%2017.png"/></a></figure><p id="1250aaf5-eccb-8077-87f1-c330b48bef39" class="">Looking at the living room example from before, we can get a very similar mosaic output.</p><figure id="1250aaf5-eccb-80eb-babe-da6a8a1ef46f" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%2018.png"><img style="width:628px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%2018.png"/></a></figure><p id="1250aaf5-eccb-80db-86e5-f841f42839d5" class="">Here is another example with my own bed room. The objects were much closer to the actual camera in this capture and the two captures had a considerable number of degrees of difference, so the result looks slightly different than the previous two. We still do see some pixelation due to downsampling of the image and interpolation.</p><figure id="1250aaf5-eccb-8062-9ebb-fda258c3f9da" class="image"><a href="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%2019.png"><img style="width:458px" src="Project%204%20Auto-stitching%20Photo%20Mosaics%201250aaf5eccb8088bf0cf0ab6c966123/image%2019.png"/></a></figure><p id="1250aaf5-eccb-80d4-96f5-fdd733042ca0" class="">Something I noticed with this example is how the homography started to actually diverges from the reference function <code>cv2.findHomography</code>. This point was very interesting to me since I would assume more points allow for a more precise transformation, but when least squares is working with a lot of points, the optimization is essentially forced to have larger residuals. I wanted to test upper limits, so I tried 87 correspondences as my highest number.</p><h3 id="1250aaf5-eccb-80f7-82b5-f04545e1e6e3" class="">Conclusion</h3><p id="1250aaf5-eccb-808b-8ba6-fd15f53c48d3" class="">I really liked progression of this project and how it builds to the second part, but in particular, I was really amazed at the rectification concept. I find it really cool that we are able to extract different perspectives of the same object from one still image. Learning about it in lecture compared to trying it out on my own was a very fulfilling experience, especially with the different objects that I tried out.</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>